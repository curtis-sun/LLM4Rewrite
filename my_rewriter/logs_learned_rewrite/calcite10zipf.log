15:37:11,216 root INFO Improvements:
+-----------------------------------------------------------+----------------------+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                          Template                         |        Input         |         Output        |                                                                                                                                                                                                                                    Rules                                                                                                                                                                                                                                    |
+-----------------------------------------------------------+----------------------+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                      testEmptyProject                     | 0.009666666666666665 |         0.001         |                                                                                                                                                                                                                  ['PROJECT_TO_CALC', 'FILTER_VALUES_MERGE']                                                                                                                                                                                                                 |
| testNotPushFilterPastWindowWhenPredicateNotOnPartitionKey |  2095.0826666666667  |  0.05499999999999999  |                                                                                                                                                                                                              ['PROJECT_REDUCE_EXPRESSIONS', 'PROJECT_TO_CALC']                                                                                                                                                                                                              |
|                    testIsNullPushDown2                    |  28891.119333333336  |         0.001         |                                                                                                                                                                                                               ['FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REMOVE']                                                                                                                                                                                                               |
|                  testDistinctWithGrouping                 |  38882.52333333333   |   4337.8460000000005  |                                                                                                                                                                                      ['PROJECT_TO_CALC', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_REDUCE_FUNCTIONS']                                                                                                                                                                                      |
|                  testWhereNotInCorrelated                 |       300000.0       |   18360.91866666667   |                                                                                                                                                                                           ['FILTER_SUB_QUERY_TO_CORRELATE', 'FILTER_PROJECT_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE']                                                                                                                                                                                          |
|                  testSelectAnyCorrelated                  |       300000.0       |   14807.542000000001  |                                                                                                                                                                                                        ['PROJECT_SUB_QUERY_TO_CORRELATE', 'AGGREGATE_PROJECT_MERGE']                                                                                                                                                                                                        |
|                   testWhereInCorrelated                   |       300000.0       |   7262.910333333333   |                                                                                                                                                                                 ['FILTER_SUB_QUERY_TO_CORRELATE', 'JOIN_EXTRACT_FILTER', 'JOIN_PROJECT_RIGHT_TRANSPOSE', 'PROJECT_TO_CALC']                                                                                                                                                                                 |
|                    testWhereOrSubQuery                    |       300000.0       |   36169.32866666667   |                                                                                                                                                                                                     ['FILTER_SUB_QUERY_TO_CORRELATE', 'PROJECT_TO_CALC', 'CALC_REMOVE']                                                                                                                                                                                                     |
|                          testSome                         |       300000.0       |       13421.531       |                                                                                                                                                                                           ['FILTER_SUB_QUERY_TO_CORRELATE', 'FILTER_INTO_JOIN', 'PROJECT_TO_CALC', 'CALC_REMOVE']                                                                                                                                                                                           |
|           testPushAggregateFunctionsThroughJoin           |  203320.30233333333  |   8403.450666666666   |                                                                                                                                               ['JOIN_EXTRACT_FILTER', 'AGGREGATE_REDUCE_FUNCTIONS', 'AGGREGATE_PROJECT_MERGE', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'PROJECT_TO_CALC']                                                                                                                                               |
|                  testReduceConstantsCalc                  | 0.010666666666666666 | 0.0030000000000000005 | ['UNION_TO_DISTINCT', 'AGGREGATE_UNION_AGGREGATE', 'AGGREGATE_UNION_TRANSPOSE', 'AGGREGATE_UNION_AGGREGATE', 'AGGREGATE_UNION_TRANSPOSE', 'AGGREGATE_UNION_AGGREGATE', 'AGGREGATE_UNION_TRANSPOSE', 'AGGREGATE_UNION_AGGREGATE', 'AGGREGATE_UNION_TRANSPOSE', 'AGGREGATE_UNION_AGGREGATE', 'UNION_MERGE', 'PROJECT_REDUCE_EXPRESSIONS', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_SET_OP_TRANSPOSE', 'FILTER_REDUCE_EXPRESSIONS', 'UNION_INSTANCE'] |
|             testReduceConstantsNegatedInverted            | 0.011666666666666665 |         0.001         |                                                                                                                                                                                                               ['PROJECT_TO_CALC', 'FILTER_REDUCE_EXPRESSIONS']                                                                                                                                                                                                              |
|                    testDecorrelateTwoIn                   |       300000.0       |   8157.874333333333   |                                                                                                                                                                       ['FILTER_SUB_QUERY_TO_CORRELATE', 'JOIN_EXTRACT_FILTER', 'JOIN_PROJECT_RIGHT_TRANSPOSE', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']                                                                                                                                                                       |
|                    testAggregateRemove2                   |  57782.67266666666   |        5043.274       |                                                                                                                                                                                                                             ['PROJECT_TO_CALC']                                                                                                                                                                                                                             |
|                    testAggregateRemove3                   |  57411.26133333333   |   4962.533333333333   |                                                                                                                                                                                                           ['AGGREGATE_REMOVE', 'PROJECT_MERGE', 'PROJECT_TO_CALC']                                                                                                                                                                                                          |
|               testWhereAnyCorrelatedInSelect              |       300000.0       |   15313.934666666666  |                                                                                                      ['FILTER_SUB_QUERY_TO_CORRELATE', 'JOIN_EXTRACT_FILTER', 'JOIN_PROJECT_RIGHT_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_INTO_JOIN', 'PROJECT_REDUCE_EXPRESSIONS', 'PROJECT_MERGE', 'PROJECT_TO_CALC']                                                                                                     |
|                 testReduceConstantsIsNull                 | 0.006333333333333333 |         0.001         |                                                                                                                                                                                                              ['FILTER_REDUCE_EXPRESSIONS', 'PROJECT_INSTANCE']                                                                                                                                                                                                              |
|                     testIsNullPushDown                    |      68552.787       |         0.001         |                                                                                                                                                                                                               ['FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REMOVE']                                                                                                                                                                                                               |
|        testMaxReuseDistinctAttrWithMixedOptionality       |  37907.621666666666  |   6838.1050000000005  |                                                                                                                                                                             ['PROJECT_TO_CALC', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_REDUCE_FUNCTIONS', 'PROJECT_TO_CALC']                                                                                                                                                                            |
|           testSumAndDistinctSumWithExpandSumType          |      20168.214       |   4109.935999999999   |                                                                                                                                                                         ['AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_REDUCE_FUNCTIONS', 'AGGREGATE_PROJECT_MERGE', 'PROJECT_TO_CALC']                                                                                                                                                                        |
|                    testAggregateMerge1                    |  126678.81666666667  |        8092.639       |                                                                                                                                                                                                 ['AGGREGATE_REDUCE_FUNCTIONS', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_MERGE']                                                                                                                                                                                                |
|                  testReduceValuesToEmpty                  |         0.01         |         0.001         |                                                                                                                                                                                                                       ['PROJECT_FILTER_VALUES_MERGE']                                                                                                                                                                                                                       |
|                   testAggregateMergeSum0                  |  18043.576666666664  |   17863.05233333333   |                                                                                                                                                                                              ['PROJECT_TO_CALC', 'AGGREGATE_REDUCE_FUNCTIONS', 'PROJECT_TO_CALC', 'CALC_MERGE']                                                                                                                                                                                             |
|            testPushAggregateThroughOuterJoin14            |       300000.0       |   11994.167000000001  |                                                                                                                                                                                              ['AGGREGATE_PROJECT_MERGE', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'PROJECT_MERGE']                                                                                                                                                                                              |
|           testPushFilterPastAggWithGroupingSets2          |  2335.8283333333334  |   25.048333333333332  |                                                                                                                                                                          ['FILTER_AGGREGATE_TRANSPOSE', 'FILTER_PROJECT_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'PROJECT_REMOVE', 'PROJECT_TO_CALC']                                                                                                                                                                         |
|       testBitOrReuseDistinctAttrWithMixedOptionality      |      37764.039       |        6587.466       |                                                                                                                                                                             ['PROJECT_TO_CALC', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_REDUCE_FUNCTIONS', 'PROJECT_TO_CALC']                                                                                                                                                                            |
|            testExistsWithAtLeastOneRowSubQuery            |       300000.0       |   29.046999999999997  |                                                                                                                                                                                                     ['FILTER_SUB_QUERY_TO_CORRELATE', 'PROJECT_TO_CALC', 'CALC_REMOVE']                                                                                                                                                                                                     |
|                testAnyInProjectNonNullable                |  20040.899666666664  |   2617.0813333333335  |                                                                                                                                                                                    ['PROJECT_SUB_QUERY_TO_CORRELATE', 'JOIN_PROJECT_RIGHT_TRANSPOSE', 'PROJECT_MERGE', 'PROJECT_TO_CALC']                                                                                                                                                                                   |
|                  testAggregateJoinRemove4                 |  21902.101333333336  |   40.089666666666666  |                                                                                                                                                                          ['AGGREGATE_PROJECT_MERGE', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'PROJECT_JOIN_REMOVE', 'PROJECT_TO_CALC', 'CALC_REMOVE']                                                                                                                                                                          |
|                  testAggregateJoinRemove5                 |      56063.577       |   43.41833333333333   |                                                                                                                                                                 ['AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_JOIN_REMOVE', 'AGGREGATE_REMOVE', 'PROJECT_TO_CALC']                                                                                                                                                                 |
|                 testSelectNotInCorrelated                 |       300000.0       |   34960.31166666667   |                                                                                                                                                                                          ['PROJECT_SUB_QUERY_TO_CORRELATE', 'AGGREGATE_PROJECT_MERGE', 'FILTER_PROJECT_TRANSPOSE']                                                                                                                                                                                          |
|             testDistinctCountWithExpandSumType            |  20148.195000000003  |   4011.0636666666664  |                                                                                                                                                                                                 ['AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_PROJECT_MERGE']                                                                                                                                                                                                 |
|                 testPullConstantIntoFilter                |  1368.8746666666666  |  0.015666666666666666 |                                                                                                                                                                 ['FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_MERGE', 'PROJECT_MERGE', 'PROJECT_TO_CALC']                                                                                                                                                                 |
|                   testEmptySortLimitZero                  |  70.32166666666667   |         0.001         |                                                                                                                                                                                                                         ['SORT_FETCH_ZERO_INSTANCE']                                                                                                                                                                                                                        |
|                  testRemoveDistinctOnAgg                  |  135803.70433333333  |   62125.793333333335  |                                                                                                                                                               ['AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_REDUCE_FUNCTIONS', 'AGGREGATE_REMOVE', 'AGGREGATE_PROJECT_MERGE', 'PROJECT_TO_CALC']                                                                                                                                                              |
|                     testEmptyIntersect                    | 0.012666666666666666 |         0.009         |                                                                                                                                                                                            ['PROJECT_FILTER_VALUES_MERGE', 'PROJECT_REDUCE_EXPRESSIONS', 'PROJECT_VALUES_MERGE']                                                                                                                                                                                            |
|                testExpandProjectInNullable                |       300000.0       |   14732.534666666666  |                                                                                                                                                                                                            ['PROJECT_SUB_QUERY_TO_CORRELATE', 'PROJECT_TO_CALC']                                                                                                                                                                                                            |
|        testMinReuseDistinctAttrWithMixedOptionality       |  37832.59733333333   |   6542.531333333333   |                                                                                                                                                                             ['PROJECT_TO_CALC', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_REDUCE_FUNCTIONS', 'PROJECT_TO_CALC']                                                                                                                                                                            |
+-----------------------------------------------------------+----------------------+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
15:37:11,216 root INFO Improved 38 out of 44 queries
15:37:11,216 root INFO Average: 15938.078924242423
15:37:11,216 root INFO Median: 4962.533333333333
15:37:11,216 root INFO 90th Percentile: 34960.31166666667
15:37:11,216 root INFO 95th Percentile: 62125.793333333335
15:37:11,216 root INFO Average Input: 106306.50350757573
15:37:11,216 root INFO Median Input: 37907.621666666666
15:37:11,216 root INFO 90th Percentile Input: 300000.0
15:37:11,216 root INFO 95th Percentile Input: 300000.0
15:37:11,216 root INFO Average Total Time: 734.1363636363636
